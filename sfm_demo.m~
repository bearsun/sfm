function sfm_demo
% a sfm demo to collect behaviour data for ambiguous structure-from-motion
% from Gijs Joost Brouwer and Raymond van Ee, 2007
% sphere: height/length: 8.2 vd, 500 dots, rotating around vertical axis
% each dot: 5.8 arcmin in diameter
% central fixation: 11.7 arcmin
% angular volecity of the sphere: 16 vd/s
% average speed of the dots: 0.75 vd/s

AssertOpenGL;

% Parameters
vddot = .1; % In vd
vdsphere = 8.2;
ndots = 500;
vdfix = .2;
spdsphere = 16; % in vd/s

screenid = max(Screen('Screens'));
FrameRate = Screen('NominalFrameRate', screenid);

% Determine the values of black and white
black = BlackIndex(screenid);
white = WhiteIndex(screenid);

% Set up our screen
[window, windowRect] = PsychImaging('OpenWindow', screenid, black);

% calculate x and y for each dot
angle = (rand(2, ndots).*2 -1) .* 180; % in 3d
Updateangle = spdsphere /  FrameRate; % vd per frame

while ~KbCheck

    angle_2d = sind(angle).* (vdsphere / 2);

    Screen('DrawDots', window, [xpos; ypos], dotSizePixels, white, center, 1);

    Screen('Flip', window);

    % Increment the angle of the dots by one degree per frame
    angles = angles + 1;

end

end